C*********************************************************************
C*
C*
C*	   программа, обратная п/п convgd в программе rdconv.
C*	  осуществляет перевод контурной и векторной информации в
C*	  географическую систему координат
C*
C* параметры: fi,lambda - начало координат (географ.)
C*	      xy(n,2) - координаты точек (itypcn=0 - в 10км, itypcn=1 -
C*		в градусах)(вход). на выходе - в географической системе
C*		координат
C*	      v(n,2) - скорости перемещения маркеров (в см/сек на 
C*		входе). на выходе - точка перемещения маркера с
C*		расстоянием от xy, пропорциональным скорости
C*	      dx,dy - соответствующие коэффициенты пропорциональности
C*	      inftyp - тип информации на входе:
C*		0 - на входе xy,
C*		1 - xy и v
C*	      itypcn - в каких единицах измеряется xy:
C*	      0 - в декартовой системе координат в 10км
C*	      1 - в относительной географической системе координат в гр.
C*
C*
C*********************************************************************
	subroutine cnkmdg(fi,lambda,xy,v,n,dx,dy,inftyp,itypcn)
	real xy(n,2),v(n,2),lami,lambda
	data onedg/111.24/,r0/6378.245/,pi/3.1415926/
	do 50 i=1,n
c*		преобразование xy
	if(itypcn.eq.0) go to 10
c*		xy в географической системе координат
	xy(i,1)=xy(i,1)+fi
	xy(i,2)=xy(i,2)+lambda
	go to 40
c*		преобразование данных из декартовой системы координат в
c*		географическую
10	call  dgkm(x0,y0,fi,lambda)
	y=xy(i,2)*10.+y0
	lami=y/onedg
	rearth=r0*(1.-0.00335*sin(lami*pi/180.)**2)
	rlitl=rearth*cos(lami*pi/180.)
	fii=fi+xy(i,1)*1800./pi/rlitl
	if(fii.gt.180.) fii=fii-360.
	xy(i,1)=fii
	xy(i,2)=lami
40	if(inftyp.eq.0) go to 50
c*		преобразование v
	v(i,1)=xy(i,1)+v(i,1)*dx
	v(i,2)=xy(i,2)+v(i,2)*dy
50	continue
	return
	end
	